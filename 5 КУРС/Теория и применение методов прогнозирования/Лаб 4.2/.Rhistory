else{ind[i,1]=0}
}
}
object = gbm(B[ind==1,]$SeriousDlqin2yrs~.,data=B[ind==1,],distribution="adaboost",n.trees=100,shrinkage=0.01,interaction.depth=10,n.minobsinnode=7)
tr <- predict(object,newdata=B,n.trees=100,type="response")
sol_tst = sol_tst + predict(object,newdata=A_test,n.trees=100,type="response")
k = 0
k1 = 0
for(i in 1:nr){     
     if(ind[i,1] == 1){k = k + 1}    
     else{          
           sol_pass[i,1] = sol_pass[i,1] + 1
           sol_pass[i,2] = sol_pass[i,2] + tr[i]          
           k1 = k1 + 1
     }    
}
jj
length(ind[ind==1])
length(sol_pass[sol_pass[sol_pass[i,1]!=0],1])
auc(B[,2],tr)
}
length(ind[ind==1])
length(sol_pass[sol_pass[sol_pass[i,1]!=0],1])
auc(B[,2],tr)
A <- read.table("cs-test.csv",header=TRUE,sep=",",NA=0)
A_train<- A[sample(1:nrow(A), 80000, replace=FALSE),]
A0 <- A_train[A_train[,2]==0,]
A1 <- A_train[A_train[,2]==1,]
nc=10
rates = matrix(0,1,nc)
for(i in 1:nc){
     i1=i+2
     m0 = mean(A0[,i1])    
     m1 = mean(A1[,i1])
     s0 = sd(A0[,i1])    
     s1 = sd(A1[,i1])
     rates[i] = abs(m0-m1)/(s0+s1)
}
barplot(rates, main="KFD", xlab="feature", names.arg=c(1:10))
B = rbind(A_train) #объединяем наборы данных
ind=matrix(0,nr,1)
alfa=0.85 #указывает, что используется 85% плохих клиентов
beta=0.05 #указывает, что используется 5% хороших клиентов
for(i in 1:nr){
q = runif(1)
if(B[i,2]==1 && q<=alfa){ind[i,1]=1}
else{
q = runif(1)
if(B[i,2]==0 && q<=beta){ind[i,1]=1}}}
object <- nnet(B[ind==1,]$SeriousDlqin2yrs~., data=B[ind==1,], size=20)
pr <- predict(object, A_validate)
plot(pr) #строим график
A_train<- A[sample(1:nrow(A), 80000, replace=FALSE),]
A0 <- A_train[A_train[,2]==0,]
A1 <- A_train[A_train[,2]==1,]
nc=10
rates = matrix(0,1,nc)
for(i in 1:nc){
     i1=i+2
     m0 = mean(A0[,i1])    
     m1 = mean(A1[,i1])
     s0 = sd(A0[,i1])    
     s1 = sd(A1[,i1])
     rates[i] = abs(m0-m1)/(s0+s1)
}
barplot(rates, main="KFD", xlab="feature", names.arg=c(1:10))
object <- lm(A_train$SeriousDlqin2yrs~A_train$RevolvingUtilizationOfUnsecuredLines+A_train$DebtRatio+A_train$MonthlyIncome+A_train$NumberRealEstateLoansOrLines,data=A)
sol_vld <- predict(object,newdata=A_train)
Z <- auc(A_train[,2],sol_vld)  
print(Z)
leaf <- read.table("leaf2-4.txt", head=TRUE, as.is=TRUE, sep=";")
str(leaf)
summary(leaf)
kuvl <- ts(leaf$K.UVL, frequency=36)
str(kuvl)
acf(kuvl, main="")
plot(stl(kuvl, s.window="periodic")$time.series, main="")
birth <-scan("nybirths.dat")
is.vector(birth)
birth <- scan("nybirths.dat")
birth <- scan("http://robjhyndman.com/tsdldata/data/nybirths.dat")
birth <- scan("http://robjhyndman.com/tsdldata/data/nybirths.dat")
is.vector(birth)
head(birth)
birth.ts <- ts(birth, start = c(1996, 1), frequency = 12)
birth.ts
plot.ts(birth)
birthtscomponents <- decompose(birth.ts)
plot(birthtscomponents)
acf(birth.ts, main="")
plot(stl(birth.ts, s.window="periodic")$time.series, main="")
dollar <- read.table("dollar.txt", head=TRUE, as.is=TRUE, sep=";")
dollar <- scan("http://robjhyndman.com/tsdldata/data/nybirths.dat")
dollar.ts <- ts(dollar, start = c(2011, 1), frequency = 12)
acf(dollar.ts, main="")
plot(stl(dollar.ts, s.window="periodic")$time.series, main="")
acf(dollar.ts, main="")
plot(stl(dollar.ts, s.window="periodic")$time.series, main="")
dollar <- ts(read.table("dollar.txt")$V3, start=c(2011,7), frequency=12)
d <- ts(cumsum(dollar), start=c(2011,7), frequency=12)
plot(dollar, type="b", log="y", xlab="")
plot(d, type="b", ylim=c(1,3000), log="y")
model01 <- arima(d, order=c(0,0,1)) 
model02 <- arima(d, order=c(0,0,2)) 
model03 <- arima(d, order=c(0,0,3)) 
model04 <- arima(d, order=c(0,0,4)) 
model05 <- arima(d, order=c(0,0,5)) 
model06 <- arima(d, order=c(0,0,6)) 
model07 <- arima(d, order=c(0,0,7)) 
model08 <- arima(d, order=c(0,0,8)) 
model09 <- arima(d, order=c(0,0,9)) 
model010 <- arima(d, order=c(0,0,10)) 
model011 <- arima(d, order=c(0,0,11)) 
model012 <- arima(d, order=c(0,0,12)) 
model013 <- arima(d, order=c(0,0,13)) 
model014 <- arima(d, order=c(0,0,14))dollar <- scan("http://robjhyndman.com/tsdldata/data/nybirths.dat")
dollar.ts <- ts(dollar, start = c(2011, 7), frequency = 12)
acf(dollar.ts, main="")
dollar <- scan("dollar.txt")
dollar.ts <- ts(dollar, start = c(2011, 7), frequency = 12)
acf(dollar.ts, main="")
dollar <- read.table("dollar.txt", head=TRUE, as.is=TRUE, sep=";")
dollar.ts <- ts(dollar, start = c(2011, 7), frequency = 12)
acf(dollar.ts, main="")
plot(stl(dollar.ts, s.window="periodic")$time.series, main="")
dollar.ts <- ts(dollar, start = c(2011, 1), frequency = 12)
acf(dollar.ts, main="")
plot(stl(dollar.ts, s.window="periodic")$time.series, main="")
dollar <- read.table("dollar.txt", head=TRUE, as.is=TRUE, sep="\t")
dollar
dollar.ts <- ts(dollar, start = c(2011, 1), frequency = 12)
dollar.ts
acf(dollar.ts, main="")
plot(stl(dollar.ts, s.window="periodic")$time.series, main="")
dollar <- scan("dollar.txt")
dollar <- read.table("dollar.txt", head=TRUE, as.is=TRUE, sep="\t")
file.show("dollar.txt")
str(dollar)
summary(dollar)
dollar.ts <- ts(dollar, start = c(2011, 7), frequency = 12)
dollar.ts
acf(dollar.ts, main="")
acf(dollar.ts, main="")
plot.ts(dollar)
dollar <- ts(read.table("dollar.txt"), start=c(2011,7), frequency=12)
plot(dollar, type="b", log="y", xlab="")
d <- ts(cumsum(dollar), start=c(2011,7), frequency=12)
d <- ts(cumsum(dollar), start=c(2011,7), frequency=12)
plot(d, type="b", ylim=c(1,3000), log="y")
plot(dollar, type="b", log="y", xlab="")
dollar.ts <- ts(dollar, start = c(2011, 6, 1), end=c(2011, 6, 26) frequency = 1)
dollar.ts <- ts(dollar, start = c(2011, 6, 1), end=c(2011, 6, 26), frequency = 1)
dollartscomponents <- decompose(dollar.ts)
plot(dollartscomponents)
polzovateli <- ts(read.table("F:/data.txt")$V3, start=c(2004,12), frequency=12
)
polzovateli <- ts(read.table("data.txt")$V3, start=c(2004,12), frequency=12)
abonents <- ts(cumsum(polzovateli), start=c(2004,12), frequency=12)
plot(polzovateli, type="b", log="y", xlab="")
plot(abonents, type="b", ylim=c(1,3000), log="y")
model01 <- arima(abonents, order=c(0,0,1)) 
model02 <- arima(abonents, order=c(0,0,2)) 
model03 <- arima(abonents, order=c(0,0,3)) 
model04 <- arima(abonents, order=c(0,0,4)) 
model05 <- arima(abonents, order=c(0,0,5)) 
model06 <- arima(abonents, order=c(0,0,6)) 
model07 <- arima(abonents, order=c(0,0,7)) 
model08 <- arima(abonents, order=c(0,0,8)) 
model09 <- arima(abonents, order=c(0,0,9)) 
model010 <- arima(abonents, order=c(0,0,10)) 
model011 <- arima(abonents, order=c(0,0,11)) 
model012 <- arima(abonents, order=c(0,0,12)) 
model013 <- arima(abonents, order=c(0,0,13)) 
model014 <- arima(abonents, order=c(0,0,14)) 
plot(AIC(model01, model02, model03, model04, model05, model06, model07, model08, model09, model010, model011, model012, model013, model014), type="b")
model012 <- arima(abonents, order=c(0,0,12)) 
model112 <- arima(abonents, order=c(1,0,12)) 
model212 <- arima(abonents, order=c(2,0,12)) 
model312 <- arima(abonents, order=c(3,0,12)) 
model412 <- arima(abonents, order=c(4,0,12))
AIC(model012, model112, model212, model312, model412)
model2120 <- arima(abonents, order=c(2,0,12))
model2121 <- arima(abonents, order=c(2,1,12))
model2122 <- arima(abonents, order=c(2,2,12))
model2123 <- arima(abonents, order=c(2,3,12))
model2124 <- arima(abonents, order=c(2,4,12))
model2125 <- arima(abonents, order=c(2,5,12)) 
model2120 <- arima(abonents, order=c(2,0,12))
model2121 <- arima(abonents, order=c(2,1,12))
model2122 <- arima(abonents, order=c(2,2,12))
model2123 <- arima(abonents, order=c(2,3,12))
model2124 <- arima(abonents, order=c(2,4,12))
model2125 <- arima(abonents, order=c(2,5,12)) 
AIC(model2120, model2121 ,model2122, model2123, model2124)
plot(abonents, xlim=c(2004.7,2010), ylim=c(0,6500)) 
lines(predict(model2123, n.ahead=12, se.fit = TRUE)$pred,col="green")
lines(predict(model2123, n.ahead=12, se.fit = TRUE)$se + predict(model2123, n.ahead=12, se.fit = TRUE)$pred, col="red")
lines(-predict(model2123, n.ahead=12, se.fit = TRUE)$se +  predict(model2123, n.ahead=12, se.fit = TRUE)$pred,col="blue")
round(predict(model2123, n.ahead=12, se.fit = TRUE)$se + predict(model2123, n.ahead=12, se.fit = TRUE)$pred)
round(-predict(model2123, n.ahead=12, se.fit = TRUE)$se + predict(model2123, n.ahead=12, se.fit = TRUE)$pred)
dollar_price <- ts(read.table("dollar.txt")$V3, start=c(2011,6), frequency=1)
dddd <- ts(cumsum(dollar_price), start=c(2011,6), frequency=1)
plot(dollar_price, type="b", log="y", xlab="")\
plot(dollar_price, type="b", log="y", xlab="")
dollar_price <- ts(read.table("dollar.txt")$V3, start=c(2011,6), frequency=12)
dddd <- ts(cumsum(dollar_price), start=c(2011,6), frequency=12)
plot(dollar_price, type="b", log="y", xlab="")
dddd
dollar_price <- ts(read.table("dollar.txt"), start=c(2011,6), frequency=12)
dddd <- ts(cumsum(dollar_price), start=c(2011,6), frequency=12)
dddd
dollar_price
dollar_price <- ts(read.table("dollar.txt"), start=c(2011,6), frequency=1)
dddd <- ts(cumsum(dollar_price), start=c(2011,6), frequency=1)
dddd
dollar_price
dollar_price <- ts(read.table("dollar.txt"), start=c(2011,1), frequency=1)
dddd <- ts(cumsum(dollar_price), start=c(2011,1), frequency=1)
dddd
dollar_price
plot(dollar_price, type="b", log="y", xlab="")
plot(dddd, type="b", ylim=c(1,3000), log="y")
dollar_price <- scan(dollar.txt)
dollar_price <- scan(read.table("dollar.txt"))
dollar_price <- scan(read.table("dollar.txt", head=TRUE, as.is=TRUE, sep="\t"))
tab = read.csv2("progression.csv", encoding = 'UTF-8')
tab
tab <- read.table("progression.csv", header=TRUE, sep=",", na.strings="NA", strip.white=TRUE)
tab
time <- ts(tab$Time, frequency=36)
str(time)
acf(time, main="")
time <- ts(tab$Time, frequency=1)
str(time)
acf(time, main="")
plot(stl(time, s.window="periodic")$time.series, main="")
tab <- read.table("droughts.csv", header=TRUE, sep=",", na.strings="NA", strip.white=TRUE)
time <- ts(tab$length, frequency=1)
str(time)
acf(time, main="")
plot(stl(time, s.window="periodic")$time.series, main="")
time <- ts(tab$length, frequency=12)
str(time)
acf(time, main="")
plot(stl(time, s.window="periodic")$time.series, main="")
acf(time, main="")
plot(stl(time, s.window="periodic")$time.series, main="")
acf(time, main="")
plot(stl(time, s.window="periodic")$time.series, main="")
library("TTR")
utils:::menuInstallPkgs()
local({pkg <- select.list(sort(.packages(all.available = TRUE)),graphics=TRUE)
if(nchar(pkg)) library(pkg, character.only=TRUE)})
oil <- load("F:/oil.rda")
oil
oil <- load("oil.rda")
oil
oildata <- window(oil,start=1996,end=2007)
plot(oildata, ylab="Oil (millions of tonnes)",xlab="Year")
dollar1 <- read.table("dollar.txt", dec=",")$V3
dollar1 <- read.table("dollar.txt", dec=",")$V3
dollar <- ts(dollar1[1:56], frequency=7)
dollartscomponents <- decompose(dollar.ts)
plot(dollartscomponents)
acf(dollar.ts, main="")
dollartscomponents <- decompose(dollar)
plot(dollartscomponents)
dollar1
dollar <- read.table("dollar.txt", dec=",")$V3
dollar_price <- ts(dollar1[1:56], frequency=7)
plot(dollar, type="b", log="y", xlab="")
plot(dollar_price, type="b", ylim=c(1,3000), log="y")
dollar <- read.table("dollar.txt", dec=",")$V3
dollar_price <- ts(dollar[1:56], frequency=7)
plot(dollar_price, type="b", ylim=c(1,3000), log="y")
dollar
dollar_price <- read.table("dollar.txt", dec=",")$V3
price.ts <- ts(dollar[1:56], frequency=7)
price.ts
dollartscomponents <- decompose(price.ts)
plot(dollartscomponents)
plot(dollar, type="b", log="y", xlab="")
plot(price.ts, type="b", log="y", xlab="")
model01 <- arima(price.ts, order=c(0,0,1)) 
model02 <- arima(price.ts, order=c(0,0,2)) 
model03 <- arima(price.ts, order=c(0,0,3)) 
model04 <- arima(price.ts, order=c(0,0,4)) 
model05 <- arima(price.ts, order=c(0,0,5)) 
model06 <- arima(price.ts, order=c(0,0,6)) 
model07 <- arima(price.ts, order=c(0,0,7)) 
model08 <- arima(price.ts, order=c(0,0,8)) 
model09 <- arima(price.ts, order=c(0,0,9)) 
model010 <- arima(price.ts, order=c(0,0,10)) 
model011 <- arima(price.ts, order=c(0,0,11)) 
model012 <- arima(price.ts, order=c(0,0,12)) 
model013 <- arima(price.ts, order=c(0,0,13)) 
model014 <- arima(price.ts, order=c(0,0,14))
plot(AIC(model01, model02, model03, model04, model05, model06, model07, model08, model09, model010, model011, model012, model013, model014), type="b")
model012 <- arima(price.ts, order=c(0,0,12)) 
model112 <- arima(price.ts, order=c(1,0,12)) 
model212 <- arima(price.ts, order=c(2,0,12)) 
model312 <- arima(price.ts, order=c(3,0,12)) 
model412 <- arima(price.ts, order=c(4,0,12))
AIC(model012, model112, model212, model312, model412)
model2121 <- arima(price.ts, order=c(2,1,12))
model2122 <- arima(price.ts, order=c(2,2,12))
model2123 <- arima(price.ts, order=c(2,3,12))
model2124 <- arima(price.ts, order=c(2,4,12))
model2125 <- arima(price.ts, order=c(2,5,12)) э
model2120 <- arima(price.ts, order=c(2,0,12))
model2121 <- arima(price.ts, order=c(2,1,12))
model2122 <- arima(price.ts, order=c(2,2,12))
model2123 <- arima(price.ts, order=c(2,3,12))
model2124 <- arima(price.ts, order=c(2,4,12))
model2125 <- arima(price.ts, order=c(2,5,12)) 
AIC(model2120, model2121 ,model2122, model2123, model2124)
plot(price.ts, xlim=c(2011.6,2011.7), ylim=c(0,6500)) 
lines(predict(model2123, n.ahead=12, se.fit = TRUE)$pred,col="green")
dollartscomponents <- decompose(price.ts)
plot(dollartscomponents)
dollartscomponents <- decompose(price.ts)
plot(dollartscomponents)
price.ts
dollar_price
dollardata <- window(dollar,start=c(1, 1),end=c(1, 7))
plot(dollardata, ylab="dollar",xlab="Year")
dollardata <- window(dollar,start=c(1, 1),end=c(8, 7))
plot(dollardata, ylab="dollar",xlab="Year")
load ("F:/ausair.rda")
air <- window(ausair, start = 1990, end = 2004)
fit1 <- holt(air, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
fit2 <- holt(air, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 5)
fit3 <- holt(air, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "simple", h = 5)
plot(fit2, type = "o", ylab = "Air passengers in Australia (millions)", xlab = "Year",  fcol = "white", plot.conf = FALSE)
lines(fitted(fit1), col = "blue")
lines(fitted(fit2), col = "red")
lines(fitted(fit3), col = "green")
lines(fit1$mean, col = "blue", type = "o")
lines(fit2$mean, col = "red", type = "o")
lines(fit3$mean, col = "green", type = "o")
legend("topleft", lty = 1, col = c("black", "blue", "red", "green"), legend=c("Data", "Holt's linear trend", "Exponential trend", "Additive damped trend"))
install.packages("fpp")
require(fpp)
fit1 <- ses(oildata, alpha=0.2, initial="simple", h=3)
fit2 <- ses(oildata, alpha=0.6, initial="simple", h=3)
fit3 <- ses(oildata, h=3)
plot(fit1, plot.conf=FALSE, ylab="Oil (millions of tonnes)",
  xlab="Year", main="", fcol="white", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("topleft",lty=1, col=c(1,"blue","red","green"),c("data", expression(alpha == 0.2), expression(alpha == 0.6), expression(alpha == 0.89)),pch=1)
load("oil.rda")
oil
oildata <- window(oil,start=1996,end=2007)
plot(oildata, ylab="Oil (millions of tonnes)",xlab="Year")
oilSMA3 <- SMA(oil,n=3)
plot.ts(oilSMA3)
oilSMA8 <- SMA(oil,n=8)
plot.ts(oilSMA8)
fit1 <- ses(oildata, alpha=0.2, initial="simple", h=3)
fit2 <- ses(oildata, alpha=0.6, initial="simple", h=3)
fit3 <- ses(oildata, h=3)
plot(fit1, plot.conf=FALSE, ylab="Oil (millions of tonnes)",
  xlab="Year", main="", fcol="white", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("topleft",lty=1, col=c(1,"blue","red","green"),c("data", expression(alpha == 0.2), expression(alpha == 0.6), expression(alpha == 0.89)),pch=1)
load ("ausair.rda")
air <- window(ausair, start = 1990, end = 2004)
fit1 <- holt(air, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
fit2 <- holt(air, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 5)
fit3 <- holt(air, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "simple", h = 5)
plot(fit2, type = "o", ylab = "Air passengers in Australia (millions)", xlab = "Year",  fcol = "white", plot.conf = FALSE)
lines(fitted(fit1), col = "blue")
lines(fitted(fit2), col = "red")
lines(fitted(fit3), col = "green")
lines(fit1$mean, col = "blue", type = "o")
lines(fit2$mean, col = "red", type = "o")
lines(fit3$mean, col = "green", type = "o")
legend("topleft", lty = 1, col = c("black", "blue", "red", "green"), legend=c("Data", "Holt's linear trend", "Exponential trend", "Additive damped trend"))
dollar_price <- read.table("dollar.txt", dec=",")$V3
pricets <- ts(dollar_price[1:56], frequency=7)
pricets
dollardata <- window(dollar,start=c(1, 1),end=c(8, 7))
plot(dollardata, ylab="dollar",xlab="")
dollardata <- window(dollar_price,start=c(1, 1),end=c(8, 7))
plot(dollardata, ylab="dollar",xlab="")
dolSMA3 <- SMA(pricets,n=3)
plot.ts(dolSMA3)
fit1 <- ses(dollardata, alpha=0.2, initial="simple", h=3)
fit2 <- ses(dollardata, alpha=0.6, initial="simple", h=3)
fit3 <- ses(dollardata, h=3)
plot(fit1, plot.conf=FALSE, ylab="dollar",
  xlab="Year", main="", fcol="white", type="o")
lines(fitted(fit1), col="blue", type="o")
lines(fitted(fit2), col="red", type="o")
lines(fitted(fit3), col="green", type="o")
lines(fit1$mean, col="blue", type="o")
lines(fit2$mean, col="red", type="o")
lines(fit3$mean, col="green", type="o")
legend("topleft",lty=1, col=c(1,"blue","red","green"),c("data", expression(alpha == 0.2), expression(alpha == 0.6), expression(alpha == 0.89)),pch=1)
air <- window(dollardata, start=c(1, 1),end=c(8, 7))
fit1 <- holt(air, alpha = 0.8, beta = 0.2, initial = "simple", h = 5)
fit2 <- holt(air, alpha = 0.8, beta = 0.2, initial = "simple", exponential = TRUE, h = 5)
fit3 <- holt(air, alpha = 0.8, beta = 0.2, damped = TRUE, initial = "simple", h = 5)
plot(fit2, type = "o", ylab = "dollar", xlab = "Year",  fcol = "white", plot.conf = FALSE)
lines(fitted(fit1), col = "blue")
lines(fitted(fit2), col = "red")
lines(fitted(fit3), col = "green")
lines(fit1$mean, col = "blue", type = "o")
lines(fit2$mean, col = "red", type = "o")
lines(fit3$mean, col = "green", type = "o")
legend("topleft", lty = 1, col = c("black", "blue", "red", "green"), legend=c("Data", "Holt's linear trend", "Exponential trend", "Additive damped trend"))
install.packages("rpart")
library(rpart)
object <- rpart(A_train$SeriousDlqin2yrs~., method="class", data=A_train)
plot(object)
text(object, use.n=TRUE, all=TRUE, cex=1.4)
plot(object)
text(object, use.n=TRUE, all=TRUE, cex=0.8)
sol_trn <- predict(object,newdata=A_train)
sol_vld<-predict(object,newdata=A_validate)
S <- auc(A_train[,2],sol_trn[,2])
Z <- auc(A_validate[,2],sol_vld[,2])
S
Z
object <- gbm(A_train$SeriousDlqin2yrs~., data=A_train,distribution="bernoulli", n.trees=400, shrinkage=0.012,interaction.depth=12,n.minobsinnode = 15, verbose=TRUE, cv.folds=2)
S <- auc(A_train[,2],sol_trn)
print(S)
plot(roc(A_train[,2],sol_trn))
•print(object) 
print(object) 
install.packages("caret")
install.packages("kernlab")
install.packages("randomForest")
library(caret)
library(kernlab)
library(randomForest)
library (pROC)
install.packages("kernlab")
train<-read.table ("train.csv", header=TRUE, sep=',')
#Нормализация (приведение к диапазону [0,1])
train[,-1] <- train[,-1] / 255
inTrain = data.frame(y=train[,1], train[,-1])
inTrain$y <- as.factor(inTrain$y)
#Разделение на обучающую и тестовую выборки 60/40
trainIndex = createDataPartition(inTrain$y, p = 0.60,list=FALSE) 
training = inTrain[trainIndex,]
cv = inTrain[-trainIndex,]
A <- read.table("E:/cs-test.csv",header=TRUE,sep=",")
A_test<- read.table("E:/test1.csv",header=TRUE,sep=";")
A <- read.table("cs-test.csv",header=TRUE,sep=",")
A_test<- read.table("test1.csv",header=TRUE,sep=";")
A_train<- A[sample(1:nrow(A), 80000, replace=FALSE),]
A_validate<- A[sample(1:nrow(A), 30000, replace=FALSE),]
object <- lm(A_train$SeriousDlqin2yrs~.,data=A_train)
sol_trn <- predict(object,newdata=A_train)
sol_vld<-predict(object,newdata=A_validate)
S <- auc(A_train[,2],sol_trn)
Z <- auc(A_validate[,2],sol_vld)
print(S)
print(Z)
object <- rpart(A_train$SeriousDlqin2yrs~., method="class", data=A_train)
plot(object)
text(object, use.n=TRUE, all=TRUE, cex=0.8)
sol_trn <- predict(object,newdata=A_train)
sol_vld<-predict(object,newdata=A_validate)
S <- auc(A_train[,2],sol_trn[,2])
Z <- auc(A_validate[,2],sol_vld[,2])
print(S)
print(Z)
S <- auc(A_train[,2],sol_trn)
print(S)
plot(roc(A_train[,2],sol_trn))
object <- gbm(A_train$SeriousDlqin2yrs~., data=A_train,distribution="bernoulli", n.trees=400, shrinkage=0.012,interaction.depth=12,n.minobsinnode = 15, verbose=TRUE, cv.folds=2)
S <- auc(A_train[,2],sol_trn)
print(S)
plot(roc(A_train[,2],sol_trn))
plot(object)
text(object, use.n=TRUE, all=TRUE, cex=1.4)
plot(object)
text(object, use.n=TRUE, all=TRUE, cex=0.8)
object <- rpart(A_train$SeriousDlqin2yrs~., method="class", data=A_train)
plot(object)
text(object, use.n=TRUE, all=TRUE, cex=0.8)
print(object)
sol_trn <- predict(object,newdata=A_train)
sol_vld <- predict(object,newdata=A_validate)
S <- auc(A_train[,2],sol_trn[,2])
Z <- auc(A_validate[,2],sol_vld[,2])
S
Z
object <- gbm(A_train$SeriousDlqin2yrs~., data=A_train,distribution="bernoulli", n.trees=400, shrinkage=0.012,interaction.depth=12,n.minobsinnode = 15, verbose=TRUE, cv.folds=2)
S <- auc(A_train[,2],sol_trn)
print(S)
plot(roc(A_train[,2],sol_trn))
object <- gbm(A_train$SeriousDlqin2yrs~., data=A_train,distribution="bernoulli", n.trees=200, shrinkage=0.012,interaction.depth=12,n.minobsinnode = 15, verbose=TRUE, cv.folds=2)
S <- auc(A_train[,2],sol_trn)
print(S)
plot(roc(A_train[,2],sol_trn))
S <- auc(A_train[,2],sol_trn)
print(S)
plot(roc(A_train[,2],sol_trn))
q()
